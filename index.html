<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo List</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous" />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"></script>
  </head>
  <style>
    .margin {
      margin-left: 10px;
      margin-right: 10px;
    }
  </style>
  <body>
    <div class="container-lg">
      <h1 class="text-center text-primary">ToDo list</h1>
      <div class="d-inline-flex mb-1">
        <label for="todo_input" class="text-info" style="font-size: 20px"
          >To Do :
        </label>
        

        <input
          id="todo_input"
          class="input-group-text margin"
          placeholder="Input your todo  "
          type="text " />
        <input type="button" class="btn btn-success" id="btn_add"></input>
      </div>
      <table class="table table-hover">
        <tbody id="todoTable"></tbody>
      </table>
    </div>
    <script>
      const todo_input = document.getElementById("todo_input");
      const btn_add = document.getElementById("btn_add");
      const todoTable = document.getElementById("todoTable");
      const list = [];
      let index = -1;
      let status = "Add";
         let b=-1;
      btn_add.value = status;
      btn_add.addEventListener("click", function () {
        for (let i = 0 ; i<list.length ; i++) {
          if (list[i].task === todo_input.value && index==i) {
                        alert("Task already!")
                       
          }else if(list[i].task === todo_input.value){
            alert("Task already have !!!");
            clearForm();
            return;
          }
        }
        // console.log(todo_input.value);
      if(status=="Add"){
          list.push({
          id: list.length + 1,
          task: todo_input.value,
          isDone : false
        });
      }else{
        list[index].task = todo_input.value
        list[index].isDone = false
        index = -1;
        status="Add"
        btn_add.value=status
      }
        render();
        clearForm();
      });
      todo_input.addEventListener("keypress", function (e) {
        if (e.key == "Enter") {
          btn_add.click();
        }
      });
      function render() {
        let task_string = "";

        for (let item of list) {
          if(item.isDone===true){
            task_string += `       
            <tr id="row" class="align-middle">
              <td><del>${item.id}<del/></td>
              <td><del>${item.task}<del></td>
              <td>
                <input type="button" value="üîô" class="btn btn-success" onclick="undoneTask(${item.id}) "></input>
                <button class="btn btn-light" onclick="editTask(${item.id})">‚úèÔ∏è</button>
                <button class="btn btn-warning" onclick="deleteTask(${item.id})">üóëÔ∏è</button>
                </td>
                </tr>`;
                }
                
                else{
            task_string += `       
            <tr id="row" class="align-middle">
              <td>${item.id}</td>
              <td>${item.task}</td>
              <td>
                <input type="button" value="‚úî" class="btn btn-success" onclick="doneTask(${item.id}) "></input>
                <button class="btn btn-light" onclick="editTask(${item.id})">‚úèÔ∏è</button>
                <button class="btn btn-warning" onclick="deleteTask(${item.id})">üóëÔ∏è</button>
                </td>
                </tr>`;   

                }
        }
        todoTable.innerHTML = task_string;
        
      }
      function clearForm() {
        todo_input.value = "";
        todo_input.focus();
      }
      function deleteTask(id) {
        const b = confirm("Are you sure you want to delete task ?")
        if(b){
                  index = findIndex(id);
        list.splice(index, 1);
        updateNumber()
        render();
        index = -1;
        }else{
          return
        }
      }
      function editTask(id) {
        index = findIndex(id);
        status = "‚úèÔ∏è"
        btn_add.value=status
        todo_input.value=list[index].task;
        todo_input.focus()
      }
      function doneTask(id) {
        index = findIndex(id);
        list[index].isDone=true
        render()
        index=-1
      }
        function undoneTask(id) {
        index = findIndex(id);
        list[index].isDone=false
        render()
        index=-1
      }
      function findIndex(id) {
        // console.log(id);
        for (let i = 0; i < list.length; i++) {
          if (list[i].id === id) {
            return i;
          }
        }
      }
      function updateNumber() {
  for (let i = 0; i < list.length; i++) {
    list[i].id = i + 1;
  }
}
    </script>
  </body>
</html>
